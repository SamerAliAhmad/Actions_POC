<div class="absolute inset-0 flex flex-col min-w-0 overflow-hidden">
    <div class="flex flex-col flex-auto min-w-0 h-full">
        <div class="bg-card">
            <div class="flex flex-col w-full mx-auto px-6 sm:px-8">
                <div class="flex flex-col sm:flex-row flex-auto sm:items-center min-w-0 my-8">
                    <div class="flex flex-auto items-center min-w-0">
                        <div class="flex flex-col min-w-0 ml-4">
                            <div [bdcWalkTriggerFor]="dashboardPopup1"
                                class="text-2xl md:text-4xl font-semibold tracking-tight leading-7 md:leading-snug truncate">
                                Welcome, {{currentUserName}}!</div>
                            <div class="flex items-center">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="flex flex-col flex-auto overflow-y-auto">
            <div class="flex flex-col flex-auto p-4">
                <div class="grid sm:grid-cols-2 gap-4">
                    <div class="flex flex-col flex-auto">
                        <div class="relative flex flex-col p-3 mb-4 bg-card rounded-2xl shadow text-center">
                            <div class="grid grid-cols-1 sm:grid-cols-3 w-full" style="justify-items: center;">
                                <div class="flex flex-col mx-6 my-3">
                                    <div class="text-md font-medium leading-none text-secondary">
                                        Total Sites
                                    </div>
                                    <div class="mt-2 font-medium text-3xl leading-none">
                                        {{oList_Site.length}}</div>
                                </div>
                                <div class="flex flex-col mx-6 my-3">
                                    <div class="text-md font-medium leading-none text-secondary">
                                        Total Entities
                                    </div>
                                    <div class="mt-2 font-medium text-3xl leading-none">
                                        {{oList_Entity.length}}</div>
                                </div>
                                <div class="flex flex-col mx-6 my-3">
                                    <div class="text-md font-medium leading-none text-secondary">
                                        Total Users
                                    </div>
                                    <div class="mt-2 font-medium text-3xl leading-none">
                                        {{NUMBER_OF_USERS}}</div>
                                </div>
                            </div>
                        </div>
                        <div class="shadow overflow-hidden rounded-2xl flex-auto">
                            <google-map *ngIf="isGoogleMapLoaded" class="flex-auto" height="390px" width="100%"
                                [zoom]="zoom" [center]="center" [options]="options">
                                <map-marker *ngFor="let marker of markers" [position]="marker.position"
                                    [label]="marker.label" [title]="marker.title" [options]="marker.options">
                                </map-marker>
                            </google-map>
                            <div *ngIf="!isGoogleMapLoaded" class="flex flex-auto items-center justify-center h-full">
                                Google maps failed to load</div>
                        </div>
                    </div>
                    <div class="flex flex-col flex-auto bg-card shadow rounded-2xl overflow-hidden">
                        <div class="p-6">
                            <div class="mr-4 text-lg font-medium tracking-tight leading-6 truncate">Recent
                                Activity</div>
                        </div>
                        <div *ngIf="this.logsDataSource.data.length==0 && logsLoaded"
                            class="flex flex-col flex-auto items-center justify-center h-full p-6 sm:p-10">
                            <div class="text-lg font-medium tracking-tight text-center text-secondary">
                                No User Activity Yet.
                            </div>
                        </div>
                        <div class="flex flex-col overflow-y-auto mx-6 min-h-100 h-100 max-h-100"
                            *ngIf="this.logsDataSource.data.length>0 && logsLoaded">
                            <table class="w-full bg-transparent" mat-table matSort [dataSource]="logsDataSource"
                                #logsTable>

                                <!-- Message -->
                                <ng-container matColumnDef="message">
                                    <th mat-header-cell mat-sort-header *matHeaderCellDef class="bg-white">
                                        Message
                                    </th>
                                    <td mat-cell *matCellDef="let log">
                                        <span class="pr-6">
                                            {{log.MESSAGE}}
                                        </span>
                                    </td>
                                </ng-container>

                                <!-- Date -->
                                <ng-container matColumnDef="entryDate">
                                    <th mat-header-cell mat-sort-header *matHeaderCellDef class="bg-white">
                                        Date
                                    </th>
                                    <td mat-cell *matCellDef="let log">
                                        <span class="pr-6 whitespace-nowrap">
                                            {{log.ENTRY_DATE | date:'MMM dd, y'}}
                                        </span>
                                    </td>
                                </ng-container>

                                <tr mat-header-row *matHeaderRowDef="logsTableColumns; sticky: true;"></tr>
                                <tr class="order-row h-16" mat-row *matRowDef="let row; columns: logsTableColumns;">
                                </tr>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<bdc-walk-popup #dashboardPopup1 name="dashboardPopup1" [mustCompleted]="{introModal:true}" [showCloseButton]="false"
    [showButton]="true" xPosition="after" [horizontal]="true">
    This is the dashboard, you can see the map with the location of the sites, and the latest logs</bdc-walk-popup>