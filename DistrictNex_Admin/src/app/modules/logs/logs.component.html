<div class="absolute inset-0 flex flex-col min-w-0 overflow-hidden" *ngIf="contentLoaded">
    <div class="flex flex-col flex-auto h-full bg-card dark:bg-transparent">
        <!-- Main -->

        <!-- Header -->
        <div class="flex flex-col justify-between pb-4 pt-8 px-6 md:px-8 border-b">

            <!-- Title -->
            <div class="flex flex-row">
                <div>
                    <div [bdcWalkTriggerFor]="logsPopup1" class="text-4xl font-extrabold tracking-tight leading-none">
                        Logs</div>
                    <div class="ml-0.5 mt-1 font-medium text-secondary">
                        <ng-container *ngIf="totalCount!=0">
                            {{contentLoaded?totalCount:"Loading"}}
                        </ng-container>
                        {{totalCount | i18nPlural: {
                        '=0' : 'No Logs',
                        '=1' : 'Log',
                        'other': 'Logs'
                        } }}
                    </div>
                </div>
                <div class="flex search-side-button ml-auto">
                    <button class="sm:w-30" mat-flat-button (click)="refreshLogs()">
                        <mat-icon *ngIf="!loading" [svgIcon]="'heroicons_outline:refresh'"></mat-icon>
                        <mat-progress-spinner *ngIf="loading" [diameter]="24" [mode]="'indeterminate'">
                        </mat-progress-spinner>
                        <span *ngIf="!mobileView" class="ml-2 mr-1">Refresh</span>
                    </button>
                    <button class="ml-2 sm:w-30" mat-flat-button (click)="openFiltersModal()"
                        [disabled]="!contentLoaded">
                        <mat-icon [svgIcon]="'heroicons_outline:filter'"></mat-icon>
                        <span *ngIf="!mobileView" class="ml-2 mr-1">Filters</span>
                    </button>
                    <button [bdcWalkTriggerFor]="logsPopup2" class="ml-2 sm:w-30" mat-flat-button
                        (click)="generateLogExcel()" [disabled]="!contentLoaded || downloadingReport">
                        <ng-container *ngIf="!downloadingReport">
                            <mat-icon [svgIcon]="'heroicons_outline:save'"></mat-icon>
                            <span *ngIf="!mobileView" class="ml-2 mr-1">Export</span>
                        </ng-container>
                        <mat-progress-spinner *ngIf="downloadingReport" [diameter]="24" [mode]="'indeterminate'">
                        </mat-progress-spinner>
                    </button>
                </div>
            </div>

            <!-- Main actions -->
            <div class="flex flex-wrap items-center -m-1.5 mt-2">
                <ng-container *ngIf="oList_Chosen_Access_Type">
                    <ng-container *ngFor="let accessType of oList_Chosen_Access_Type">
                        <div
                            class="flex items-center justify-center px-3 m-1 rounded-full leading-9 text-gray-500 bg-gray-100 dark:text-gray-300 dark:bg-gray-700">
                            <span class="text-md font-medium whitespace-nowrap">{{accessType.VALUE}}</span>
                            <mat-icon class="ml-1 icon-size-5 cursor-pointer" [svgIcon]="'heroicons_solid:x-circle'"
                                (click)="removeAccessTypChoice(accessType)"></mat-icon>
                        </div>
                    </ng-container>
                </ng-container>
                <ng-container *ngIf="oList_Chosen_Log_Type">
                    <ng-container *ngFor="let logType of oList_Chosen_Log_Type">
                        <div
                            class="flex items-center justify-center px-3 m-1 rounded-full leading-9 text-gray-500 bg-gray-100 dark:text-gray-300 dark:bg-gray-700">
                            <span class="text-md font-medium whitespace-nowrap">{{logType.VALUE}}</span>
                            <mat-icon class="ml-1 icon-size-5 cursor-pointer" [svgIcon]="'heroicons_solid:x-circle'"
                                (click)="removeLogTypChoice(logType)"></mat-icon>
                        </div>
                    </ng-container>
                </ng-container>
                <ng-container *ngIf="startDate || endDate">
                    <div
                        class="flex items-center justify-center px-3 m-1 rounded-full leading-9 text-gray-500 bg-gray-100 dark:text-gray-300 dark:bg-gray-700">
                        <span class="text-md font-medium whitespace-nowrap">{{startDate | date}} -
                            {{endDate | date}}</span>
                        <mat-icon class="ml-1 icon-size-5 cursor-pointer" [svgIcon]="'heroicons_solid:x-circle'"
                            (click)="removeDateChoice()"></mat-icon>
                    </div>
                </ng-container>
            </div>
        </div>


        <div *ngIf="contentLoaded" class="flex-auto overflow-auto medium-scrollbar">
            <div *ngIf="dataSource.data && dataSource.data.length > 0; else noLogs" class="mat-elevation-z3 w-full">
                <table mat-table matSort matTableResponsive [dataSource]="dataSource">

                    <ng-container matColumnDef="logTime">
                        <th mat-header-cell *matHeaderCellDef class="bg-white"> Log Time </th>
                        <td mat-cell *matCellDef="let element"> {{element.ENTRY_DATE | date: "hh:mm:ss a"}} </td>
                    </ng-container>

                    <ng-container matColumnDef="message">
                        <th mat-header-cell *matHeaderCellDef class="bg-white"> Message </th>
                        <td mat-cell *matCellDef="let element"> {{element.MESSAGE}} </td>
                    </ng-container>

                    <ng-container matColumnDef="logDate">
                        <th mat-header-cell *matHeaderCellDef class="bg-white"> Log Date </th>
                        <td mat-cell *matCellDef="let element"> {{element.ENTRY_DATE | date}} </td>
                    </ng-container>

                    <ng-container matColumnDef="logType">
                        <th mat-header-cell *matHeaderCellDef class="bg-white"> Log Type </th>
                        <td mat-cell *matCellDef="let element"> {{getLogTypeValue(element)}} </td>
                    </ng-container>

                    <ng-container matColumnDef="logAccess">
                        <th mat-header-cell *matHeaderCellDef class="bg-white"> Access Type </th>
                        <!-- <td mat-cell *matCellDef="let element"> {{element.Access_type_setup.VALUE}} </td> -->
                        <td mat-cell *matCellDef="let element"><span
                                class="inline-flex max-w-fit justify-self-end items-center font-bold text-xs px-2.5 py-0.5 rounded-full tracking-wide uppercase"
                                [ngClass]="{'bg-red-200 text-red-800': getAccessTypeValue(element) === 'Exit',
                                        'bg-green-200 text-green-800': getAccessTypeValue(element) === 'Access',
                                        'bg-yellow-200 text-yellow-800': getAccessTypeValue(element) === 'Change'}">
                                <span class="leading-relaxed whitespace-nowrap">{{getAccessTypeValue(element)}}</span>
                            </span></td>
                    </ng-container>

                    <tr mat-header-row *matHeaderRowDef="displayedColumns; sticky: true"></tr>
                    <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
                </table>
                <mat-paginator [pageSize]="pageSize" [pageSizeOptions]="[5, 10, 20, 50, 100]" [length]="totalCount"
                    [pageIndex]="pageIndex" (page)="changePage($event)" showFirstLastButtons
                    class="mat-paginator-sticky border">
                </mat-paginator>
            </div>
            <ng-template #noLogs>
                <div class="flex h-full items-center justify-center p-6 sm:p-10">
                    <div
                        class="h-full flex items-center mt-2 text-lg md:text-xl font-medium tracking-tight text-center text-secondary">
                        No Logs</div>
                </div>
            </ng-template>
        </div>
    </div>
</div>
<progress-spinner-dialog [color]="color" [mode]="mode" [value]="value" [backdropEnabled]="true"
    [positionGloballyCenter]="true" [displayProgressSpinner]="(!contentLoaded || isFetching)">
</progress-spinner-dialog>

<bdc-walk-popup #logsPopup1 name="logsPopup1" [mustCompleted]="{introModal:true}" [showCloseButton]="false"
    [showButton]="true" xPosition="after" buttonText="Next" [horizontal]="true">
    This is the logs page, you can monitor everyone's actions here and see what they are doing</bdc-walk-popup>
<bdc-walk-popup #logsPopup2 name="logsPopup2" [mustCompleted]="{logsPopup1:true}" [showCloseButton]="false"
    [showButton]="true">
    You can also download the logs in an excel file for better view</bdc-walk-popup>
